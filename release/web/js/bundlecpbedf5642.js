var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(){function e(t,n,o){function a(r,s){if(!n[r]){if(!t[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(i)return i(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){return a(t[r][1][e]||e)},d,d.exports,e,t,n,o)}return n[r].exports}for(var i="function"==typeof require&&require,r=0;r<o.length;r++)a(o[r]);return a}return e}()({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./logic/view_logic/GameLogic"),a=e("./logic/component/TopControlComponent"),i=e("./logic/view_logic/LoadLogic"),r=e("./logic/component/NetworkStateComponent"),s=e("./logic/component/GameAlertComponent"),c=function(){function e(){}return e.init=function(){var e=Laya.ClassUtils.regClass;e("logic/view_logic/GameLogic.ts",o.default),e("logic/component/TopControlComponent.ts",a.default),e("logic/view_logic/LoadLogic.ts",i.default),e("logic/component/NetworkStateComponent.ts",r.default),e("logic/component/GameAlertComponent.ts",s.default)},e.width=750,e.height=1334,e.scaleMode="fixedauto",e.screenMode="vertical",e.alignV="middle",e.alignH="center",e.startScene="MainScene.scene",e.sceneRoot="",e.debug=!1,e.stat=!1,e.physicsDebug=!1,e.exportSceneToJson=!1,e}();n.default=c,c.init()},{"./logic/component/GameAlertComponent":14,"./logic/component/NetworkStateComponent":15,"./logic/component/TopControlComponent":16,"./logic/view_logic/GameLogic":17,"./logic/view_logic/LoadLogic":18}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./GameConfig"),a=e("./core/Game");new(function(){function e(){Laya.init(o.default.width,o.default.height,Laya.WebGL),Laya.stage.scaleMode=o.default.scaleMode,Laya.stage.screenMode=o.default.screenMode,Laya.URL.exportSceneToJson=o.default.exportSceneToJson,Laya.Utils.getQueryString("debug")&&Laya.Stat.show(),Laya.alertGlobalError=!0,Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}return e.prototype.onVersionLoaded=function(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))},e.prototype.onConfigLoaded=function(){a.default.viewManage.openView(a.default.viewConfig.mainScene),a.default.viewManage.openView(a.default.viewConfig.loadView),Laya.loader.load([{url:"res/atlas/scene.atlas",type:Laya.Loader.ATLAS}],Laya.Handler.create(this,this.onComplete),new Laya.Handler(this,this.onProgress))},e.prototype.onComplete=function(){console.log("资源加载完成...开始游戏主逻辑"),new a.default.socket,console.error("缺少游戏音频上报")},e.prototype.onProgress=function(e){a.default.eventManage.event(a.default.eventType.LOAD_PROGRESS,e)},e}())},{"./GameConfig":1,"./core/Game":7}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={version:Date.now(),width:750,height:1334,res_base_brc:"res/",soundIsOn:!0,mikeIsOn:!0,hornIsOn:!0,game_control_time:30,isDebug:function(){return Laya.Utils.getQueryString("debug")}}},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./EventManage"),a=e("../data/GameData"),i=function(){function e(){}return e.runAppFunction=function(e,t){Laya.Browser.onIOS?this.detectionHasFunction(this.typeIos,e)&&(e==this.closeWebView&&(window.webkit.messageHandlers[this.leaveChannel].postMessage(JSON.stringify({status:1})),o.EventManage.event(o.GameEvent.CLOSE_SOCKET)),t?(console.log("run :"+e),window.webkit.messageHandlers[e].postMessage(t)):window.webkit.messageHandlers[e].postMessage(JSON.stringify({status:1}))):this.detectionHasFunction(this.typeAndroid,e)&&(e==this.closeWebView&&o.EventManage.event(o.GameEvent.CLOSE_SOCKET),console.log(e),t?window.JsCallback[e](t):window.JsCallback[e]())},e.detectionHasFunction=function(e,t){switch(e){case this.typeIos:if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers[t])return!0;case this.typeAndroid:if(window.JsCallback&&window.JsCallback[t])return!0}return!1},e.listenAppFunction=function(){var e=this;window.appCloseWebView=function(){e.onCloseWebView()},window.listenerById=function(t){e.onListenerById(t)}},e.onCloseWebView=function(){a.default.isStart?this.runAppFunction(this.appCloseWebViewCall,JSON.stringify({state:1})):(this.runAppFunction(this.leaveChannel),this.runAppFunction(this.appCloseWebViewCall,JSON.stringify({state:0})),this.runAppFunction(this.closeWebView))},e.onListenerById=function(e){},e.typeIos=1,e.typeAndroid=2,e.closeWebView="closeWebView",e.joinLiveChannel="joinLiveChannel",e.leaveChannel="leaveChannel",e.mikeSwitchController="mikeSwitchController",e.hornSwitchController="hornSwitchController",e.appCloseWebViewCall="appCloseWebViewCall",e.randomMatchGame="randomMatchGame",e}();n.default=i},{"../data/GameData":11,"./EventManage":6}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setData=function(e){this.data=e,this.init()},t.prototype.init=function(){},t.prototype.onDisable=function(){this.data=null},t}(Laya.Script);n.default=o},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=new Laya.EventDispatcher;n.EventManage=o;n.GameEvent={RESIZE:"resize",LOAD_PROGRESS:"load_progress",GAME_START:"game_start",GAME_OVER:"game_over",READY:"ready",GAME_ALERT:"game_alert",HEART_BEAT:"heart_beat",CLOSE_SOCKET:"close_socket",SOCKET_SEND:"socket_send",MIKE_CONTROL:"mike_control",NET_MIKE_CONTROL:"mike_control",NET_ADD_FRIEND:"add_friend",NET_LEAVE_ROOM:"leave_room",NET_HEART_BEAT:"heart_beat"}},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./EventManage"),a=e("../data/GameData"),i=e("../data/SystemData"),r=e("./ViewConfig"),s=e("./ViewManage"),c=e("../MainConfig"),l=e("./AppCore"),d=e("../data/UserDate"),p=e("./SoundManage"),u=e("../net/GameSocket"),f=function(){function e(){}return e.eventManage=o.EventManage,e.eventType=o.GameEvent,e.gameData=a.default,e.systemDate=i.default,e.viewConfig=r.default,e.viewManage=s.default,e.config=c.default,e.appCore=l.default,e.userData=d.default,e.soundManage=p.default,e.socket=u.default,e}();n.default=f},{"../MainConfig":3,"../data/GameData":11,"../data/SystemData":12,"../data/UserDate":13,"../net/GameSocket":19,"./AppCore":4,"./EventManage":6,"./SoundManage":8,"./ViewConfig":9,"./ViewManage":10}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.playSound=function(t,n,o,a){if(this.soundIsOn){return e.playSound.call(this,t,n,o,a)}},t.playMusic=function(t,n,o,a){if(this.soundIsOn){return e.playMusic.call(this,t,n,o,a)}},t.setSwitch=function(e){this.soundIsOn=e},t.soundIsOn=!0,t}(Laya.SoundManager);n.default=o},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("../ui/layaMaxUI"),a=function(){function e(){}return e.loadView={name:"loadView",class:o.ui.LoadViewUI},e.mainScene={name:"mainScene",class:o.ui.MainSceneUI},e.gameView={name:"gameView",class:o.ui.GameViewUI},e}();n.default=a},{"../ui/layaMaxUI":20}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BaseLogic"),a=function(){function e(){}return e.openView=function(e,t){var n=this.viewCache[e.name];n||(n=new e.class,this.viewCache[e.name]=n),n.parent||(Laya.stage.addChild(n),console.log("%c ==> ","color:#fff;font-weight:700;background-color:rgba(27, 144, 4, 0.7)"," open "+e.name));var a=n.getComponent(o.default);a&&a.setData&&a.setData(t)},e.closeView=function(e){var t=this.viewCache[e.name];t?t.parent&&(t.removeSelf(),console.log("%c <== ","color:#fff;font-weight:700;background-color:rgba(255, 0, 0, 0.7)"," close "+e.name)):console.warn("Lose "+e.name+" view!")},e.destroyView=function(e){var t=this.viewCache[e.name];t?(t.destroy(!0),this.viewCache[e.name]=null,console.log("%c <== ","color:#fff;font-weight:700;background-color:rgba(255, 0, 0, 0.7)"," destroy "+e.name)):console.warn("Lose "+e.name+" view!")},e.viewCache={},e}();n.default=a},{"./BaseLogic":5}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./SystemData"),a=function(){function e(){}return Object.defineProperty(e,"gameCode",{get:function(){return Laya.Utils.getQueryString("game_code")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sid",{get:function(){return Laya.Utils.getQueryString("sid")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"channelName",{get:function(){return Laya.Utils.getQueryString("channel_name")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"channelKey",{get:function(){return Laya.Utils.getQueryString("channel_key")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"gameHistoryId",{get:function(){return Laya.Utils.getQueryString("game_history_id")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"requestRoot",{get:function(){return unescape(Laya.Utils.getQueryString("request_root"))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"code",{get:function(){return Laya.Utils.getQueryString("code")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"enterFrom",{get:function(){return Laya.Utils.getQueryString("enter_from")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"wsDomain",{get:function(){return unescape(Laya.Utils.getQueryString("ws_domain"))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"gameId",{get:function(){return Laya.Utils.getQueryString("game_id")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sceneType",{get:function(){return Laya.Utils.getQueryString("scene_type")},enumerable:!0,configurable:!0}),e.socketConnect=!1,e.isStart=!1,e.isAi=!1,e.ai_user_id=22,e.isFriend=!1,e.isCanTouch=!1,e.isCanResult=!1,e.winnerId=null,e.winnerType=null,e.mark=o.default.player_type_1,e.gameStartTime=0,e.gameOverTime=0,e.selfWords="",e.hintShow=!1,e.isJoin=!1,e.isCloseVebView=!1,e}();n.default=a},{"./SystemData":12}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={view_zOrder_2000:2e3,view_zOrder_3000:3e3,view_zOrder_4000:4e3,view_zOrder_5000:5e3,view_zOrder_9999:9999,wall_zOrder:0,userRole_5:5,userRole_10:10,userRole_15:15,userRole_20:20,touch_type_1:1,touch_type_2:2,touch_type_3:3,hint_type_1:1,hint_type_2:2,hint_type_3:3,result_type_1:1,result_type_2:2,result_type_3:3,ai_type:2,sex_type_1:1,sex_type_2:2,player_type_1:0,player_type_2:1,color_type_1:1,color_type_2:2,net_id_0:0,net_id_1:1,net_id_6:6,net_id_5:5,net_id_8:8,net_id_12:12,net_id_13:13,net_guide:"proto.KNIFE",game_hint_type_0:0,game_hint_type_1:1,game_hint_type_2:2,game_hint_type_3:3,game_hint_type_4:4,game_hint_type_5:5,game_hint_type_6:6,game_hint_type_7:7,game_hint_type_8:8,game_hint_type_9:9,round_type_1:1,round_type_2:2,round_type_3:3,round_type_4:4,round_type_5:5,round_type_6:6,round_type_7:7,head_msg_type_1:1,head_msg_type_2:2,head_msg_type_3:3,head_msg_type_4:4,player_max_6:6,player_max_8:8}},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./GameData"),a=function(){function e(){this.userControlList=[],this.userList=[]}return Object.defineProperty(e,"inst",{get:function(){return this.instance||(this.instance=new e),this.instance},enumerable:!0,configurable:!0}),e.prototype.getUserList=function(){return this.userList},e.prototype.add=function(e){for(var t=this.userList,n=0,o=t.length;n<o;n++)if(t[n].user_id==e.user_id)return;e.is_leave=!1,t.push(e)},e.prototype.remove=function(e){for(var t=this.userList,n=0,o=t.length;n<o;n++)t[n]&&t[n].user_id==e&&t.splice(n,1)},e.prototype.userLeave=function(e){var t=this.getPlayerObjById(e);t&&(t.ready=!1,t.is_leave=!0)},e.prototype.hasUserLeave=function(){for(var e=this.userList,t=!1,n=0;n<e.length;n++)e[n].is_leave&&e[n].user_id!=o.default.userId&&(t=!0);return t},e.prototype.getPlayerObjById=function(e){for(var t=this.userList,n=0,o=t.length;n<o;n++)if(t[n].user_id==e)return t[n];return null},e.prototype.getPlayerObjByRole=function(e){for(var t=this.userList,n=0,o=t.length;n<o;n++)if(t[n].mark==e)return t[n];return null},e.prototype.setReadyById=function(e,t){var n=this.getPlayerObjById(e);n&&(n.ready=t,t&&(n.is_leave=!1))},e.prototype.getIsReadyById=function(e){var t=this.getPlayerObjById(e);return!!t&&t.ready},e.prototype.clearAllReady=function(){for(var e=this.userList,t=0,n=e.length;t<n;t++)e[t].ready=!1},e.prototype.clearAllPlayer=function(){this.userList=[]},e}();n.default=a},{"./GameData":11}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../core/BaseLogic"),a=e("../../core/Game"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onAwake=function(){a.default.eventManage.on(a.default.eventType.GAME_ALERT,this,this.showGameAlert)},t.prototype.showGameAlert=function(e){var t=this,n=Laya.Pool.getItemByCreateFun("gameAlert",this.alertNode.create,this.alertNode);n.zOrder=a.default.systemDate.view_zOrder_9999,n.centerY=0,n.alpha=1,this.owner.addChild(n);var o=n.getChildByName("content");o.text=e.msg,o.color=e.color?e.color:"#ffffff",e.time&&Laya.timer.once(e.time,this,function(e){t.onceTimer(e)},[n])},t.prototype.onceTimer=function(e){Laya.Tween.to(e,{centerY:-100,alpha:0},300,null,new Laya.Handler(this,function(){e.removeSelf(),Laya.Pool.recover("gameAlert",e)}))},t}(o.default);n.default=i},{"../../core/BaseLogic":5,"../../core/Game":7}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../core/BaseLogic"),a=e("../../core/Game"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onAwake=function(){a.default.eventManage.on(a.default.eventType.HEART_BEAT,this,this.delayHeart);this.owner.zOrder=a.default.systemDate.view_zOrder_9999},t.prototype.delayHeart=function(e){this.delayLabel.text=e+"ms",this.delayLabel.color=e>500?"#f15e30":"#ffffff"},t}(o.default);n.default=i},{"../../core/BaseLogic":5,"../../core/Game":7}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../core/BaseLogic"),a=e("../../core/Game"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onClick=function(e){switch(e.target.name){case"addFriendBtn":this.addFriend();break;case"mikeSwitchBtn":this.setMikeSwitch();break;case"hornSwitchBtn":this.setHornSwitch();break;case"soundBtn":this.updateSoundState()}},t.prototype.addFriend=function(){var e,t=a.default.gameData,n=a.default.systemDate,o=a.default.userData;t.mark==n.player_type_1?o.inst.getPlayerObjByRole(n.player_type_2)&&(e=o.inst.getPlayerObjByRole(n.player_type_2).user_id):o.inst.getPlayerObjByRole(n.player_type_1)&&(e=o.inst.getPlayerObjByRole(n.player_type_1).user_id),e&&(a.default.eventManage.event(a.default.eventType.SOCKET_SEND,{action:"proto.Friend",data:{user_id:e,request_root:t.requestRoot}}),this.addFriendBtn.visible=!1,this.addFriendHintControl("您已发送好友请求，请等待对方同意~"))},t.prototype.onFriend=function(e){e.user_id!=a.default.gameData.userId&&this.addFriendHintControl("对方请求加您为好友~")},t.prototype.addFriendHintControl=function(e){this.addFriendHintLabel.text=e,this.addFriendHintBox.visible=!0,this.addFriendTimeLine||(this.addFriendTimeLine=new Laya.TimeLine,this.addFriendTimeLine.to(this.addFriendHintBox,{alpha:1,y:10},300).to(this.addFriendHintBox,{alpha:0,y:-70},500,null,2500),this.addFriendHintBox.on(Laya.Event.COMPLETE,this,this.addFriendAnimationComplete)),this.addFriendTimeLine.play()},t.prototype.addFriendAnimationComplete=function(){this.addFriendHintBox.visible=!1},t.prototype.setMikeSwitch=function(){a.default.config.mikeIsOn=!a.default.config.mikeIsOn,a.default.appCore.runAppFunction(a.default.appCore.mikeSwitchController,JSON.stringify({state:a.default.config.mikeIsOn?"1":"0"})),this.mikeSwitchBtn.texture=Laya.loader.getRes(a.default.config.mikeIsOn?"scene/mike_open.png":"scene/mike_close.png"),a.default.eventManage.event(a.default.eventType.SOCKET_SEND,{action:a.default.systemDate.net_guide,data:{action:a.default.systemDate.net_id_8,mic:a.default.config.mikeIsOn}})},t.prototype.setHornSwitch=function(){a.default.config.hornIsOn=!a.default.config.hornIsOn,a.default.appCore.runAppFunction(a.default.appCore.hornSwitchController,JSON.stringify({state:a.default.config.hornIsOn?"1":"0"})),this.hornSwitchBtn.texture=Laya.loader.getRes(a.default.config.hornIsOn?"scene/horn_open.png":"scene/horn_close.png")},t.prototype.updateSoundState=function(){a.default.config.soundIsOn=!a.default.config.soundIsOn,this.soundBtn.texture=Laya.loader.getRes(a.default.config.soundIsOn?"scene/sound_open.png":"scene/sound_close.png"),a.default.soundManage.setSwitch(a.default.config.soundIsOn)},t}(o.default);n.default=i},{"../../core/BaseLogic":5,"../../core/Game":7}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(){this.owner.on(Laya.Event.RESIZE,this,this.onResize)},t.prototype.onResize=function(){this.owner.width=Laya.stage.width,this.owner.height=Laya.stage.height},t}(e("../../core/BaseLogic").default);n.default=o},{"../../core/BaseLogic":5}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../core/BaseLogic"),a=e("../../core/Game"),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadBarWidth=601,t}return __extends(t,e),t.prototype.init=function(){a.default.eventManage.on(a.default.eventType.LOAD_PROGRESS,this,this.loadProgress),this.loadBar.scrollRect=new Laya.Rectangle(0,0,0,this.loadBarWidth),this.loadBarTween||(this.loadBarTween=new Laya.Tween),this.owner.on(Laya.Event.RESIZE,this,this.onResize)},t.prototype.loadProgress=function(e){var t=this;this.loadBarTween.to(this.loadBar.scrollRect,{width:this.loadBarWidth*e},300,null,Laya.Handler.create(this,function(){1===e&&t.onCloseAnimation()}))},t.prototype.onCloseAnimation=function(){Laya.Tween.to(this.loadIcon,{y:this.loadIcon.y-100},300),Laya.Tween.to(this.loadBg,{bottom:this.loadBg.bottom-100},300),Laya.Tween.to(this,{alpha:0},300,null,new Laya.Handler(this,function(){a.default.viewManage.destroyView(a.default.viewConfig.loadView)}))},t.prototype.onDisable=function(){Laya.loader.clearTextureRes("res/atlas/load.png"),Laya.loader.clearRes("res/atlas/load.atlas"),Laya.loader.clearRes("res/atlas/load.png"),this.owner.off(Laya.Event.RESIZE,this,this.onResize)},t.prototype.onResize=function(){this.owner.width=Laya.stage.width,this.owner.height=Laya.stage.height},t}(o.default);n.default=i},{"../../core/BaseLogic":5,"../../core/Game":7}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("../core/EventManage"),a=e("../data/GameData"),i=e("../MainConfig"),r=e("../core/AppCore"),s=e("../data/UserDate"),c=function(){function e(){this.heartBeatTime=null,this.sendHeartBeatTime=null,this.isAddChannel=!1,this.init()}return e.prototype.init=function(){this.createSocket(),o.EventManage.on(o.GameEvent.CLOSE_SOCKET,this,this.setCloseSocket)},e.prototype.createSocket=function(){var e=new Laya.Socket;e.connectByUrl(a.default.wsDomain),e.on(Laya.Event.OPEN,this,this.openHandler),e.on(Laya.Event.MESSAGE,this,this.receiveHandler),e.on(Laya.Event.CLOSE,this,this.closeHandler),e.on(Laya.Event.ERROR,this,this.errorHandler),this.socket=e,o.EventManage.on(o.GameEvent.SOCKET_SEND,this,this.socketEvent)},e.prototype.setCloseSocket=function(){this.socket&&this.socket.close()},e.prototype.socketEvent=function(e){i.default.isDebug()&&"proto.HeartBeat"!=e.action&&console.log("%c ==> ","color:red;background-color:rgba(167, 167, 167, 0.2)",e),this.socket.send(e.action+"\n"+JSON.stringify(e.data?e.data:{}))},e.prototype.openHandler=function(e){void 0===e&&(e=null),console.log("begin"),a.default.socketConnect=!0,this.loginGame(),this.openHeartBeat(!0)},e.prototype.joinLiveChannel=function(){this.isAddChannel||(this.isAddChannel=!0,a.default.channelName&&a.default.channelKey&&r.default.runAppFunction(r.default.joinLiveChannel,JSON.stringify({channel_name:a.default.channelName,channel_key:a.default.channelKey})))},e.prototype.loginGame=function(){this.socketEvent({action:"proto.Login",data:{sid:a.default.sid,game_history_id:a.default.gameHistoryId,enter_from:a.default.enterFrom,request_root:a.default.requestRoot}})},e.prototype.receiveHandler=function(e){void 0===e&&(e=null),e=e.split("\n");var t=JSON.parse(e[1]);if(t.error_code)return a.default.isStart=!1,void console.error(t.error_reason);switch(i.default.isDebug()&&"HeartBeat"!=t.type&&console.log("%c <== ","color:green;background-color:rgba(167, 167, 167, 0.2)",t),t.type){case"login":this.onLogin(t);break;case"join":this.onJoin(t.result),this.joinLiveChannel();break;case"add":case"leave":case"ready":case"cancel":break;case"HeartBeat":this.onHeartBeat();break;case"mic":this.onMic(t.extra)}},e.prototype.onLogin=function(e){a.default.userId=e.extra.user_id},e.prototype.onJoin=function(e){if(e)for(var t=0,n=e.length;t<n;t++)e[t]&&s.default.inst.add(e[t])},e.prototype.onHeartBeat=function(){o.EventManage.event(o.GameEvent.HEART_BEAT,Date.now()-this.sendHeartBeatTime)},e.prototype.onMic=function(e){o.EventManage.event(o.GameEvent.MIKE_CONTROL,e)},e.prototype.closeHandler=function(e){void 0===e&&(e=null),console.log(e),console.error("close socket"),this.openHeartBeat(!1),a.default.socketConnect=!1,a.default.isStart=!1,o.EventManage.event(o.GameEvent.GAME_ALERT,{msg:"连接出错啦，请退出重试！",color:"#ff0000"})},e.prototype.errorHandler=function(e){void 0===e&&(e=null),console.log(e),console.error("error"),this.openHeartBeat(!1),a.default.socketConnect=!1,a.default.isStart=!1,o.EventManage.event(o.GameEvent.GAME_ALERT,{msg:"连接出错啦，请退出重试！",color:"#ff0000"})},e.prototype.openHeartBeat=function(e){var t=this;e?(this.heartBeatTime&&clearInterval(this.heartBeatTime),this.heartBeatTime=setInterval(function(){t.sendHeartBeatTime=Date.now(),t.socketEvent({action:"proto.HeartBeat"})},1e3)):this.heartBeatTime&&clearInterval(this.heartBeatTime)},e}();n.default=c},{"../MainConfig":3,"../core/AppCore":4,"../core/EventManage":6,"../data/GameData":11,"../data/UserDate":13}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=Laya.View;!function(e){!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.createView(t.uiView)},t.uiView={type:"View",props:{width:750,top:0,right:0,left:0,height:70},compId:1,child:[{type:"Image",props:{top:0,texture:"scene/game_bg_alpha_50.png",skin:"scene/game_bg_alpha_50.png",sizeGrid:"2,2,2,2",right:0,left:0,height:70},compId:2},{type:"Box",props:{width:750,top:0,height:70,centerX:0},compId:3,child:[{type:"Sprite",props:{y:8,x:355,texture:"scene/add_friend.png",name:"addFriendBtn",mouseEnabled:!0},compId:4},{type:"Sprite",props:{y:8,x:435,texture:"scene/mike_open.png",name:"mikeSwitchBtn",mouseEnabled:!0},compId:5},{type:"Sprite",props:{y:8,x:515,texture:"scene/horn_open.png",name:"hornSwitchBtn",mouseEnabled:!0},compId:6},{type:"Sprite",props:{y:8,x:595,texture:"scene/sound_open.png",name:"soundBtn",mouseEnabled:!0},compId:7},{type:"Sprite",props:{y:8,x:675,texture:"scene/question_icon.png",name:"questionBtn",mouseEnabled:!0},compId:8},{type:"Image",props:{y:-70,width:454,skin:"scene/game_bg_alpha_50.png",sizeGrid:"2,2,2,2",name:"addFriendHintBox",height:60,centerX:0},compId:10,child:[{type:"Label",props:{x:-189,text:"您已发送好友请求，请等待对方同意",name:"addFriendHintLabel",fontSize:26,color:"#ffffff",centerY:0,centerX:0},compId:12}],components:[]}],components:[]}],loadList:["scene/game_bg_alpha_50.png","scene/add_friend.png","scene/mike_open.png","scene/horn_open.png","scene/sound_open.png","scene/question_icon.png"],loadList3D:[],components:[]},t}(o);e.TopControlComponentUI=t}(e.component||(e.component={}))}(n.ui||(n.ui={})),function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.createView(t.uiView)},t.uiView={type:"View",props:{width:750,top:0,right:0,left:0,height:1334,bottom:0},compId:1,child:[{type:"Script",props:{runtime:"logic/view_logic/GameLogic.ts"},compId:28},{type:"Box",props:{presetID:1,y:0,x:0,width:750,right:0,mouseEnabled:!0,left:0,isPresetRoot:!0,height:70},compId:32,child:[{type:"Image",props:{presetID:2,y:10,x:10,top:0,texture:"scene/game_bg_alpha_50.png",skin:"scene/game_bg_alpha_50.png",sizeGrid:"2,2,2,2",right:0,left:0,height:70},compId:14},{type:"Box",props:{presetID:3,y:10,x:10,width:750,top:0,mouseEnabled:!0,height:70,centerX:0},compId:15,child:[{type:"Sprite",props:{presetID:4,y:8,x:355,texture:"scene/add_friend.png",name:"addFriendBtn",mouseEnabled:!0},compId:16},{type:"Sprite",props:{presetID:5,y:8,x:435,texture:"scene/mike_open.png",name:"mikeSwitchBtn",mouseEnabled:!0},compId:17},{type:"Sprite",props:{presetID:6,y:8,x:515,texture:"scene/horn_open.png",name:"hornSwitchBtn",mouseEnabled:!0},compId:18},{type:"Sprite",props:{presetID:7,y:8,x:595,texture:"scene/sound_open.png",name:"soundBtn",mouseEnabled:!0},compId:19},{type:"Sprite",props:{presetID:8,y:8,x:675,texture:"scene/question_icon.png",name:"questionBtn",mouseEnabled:!0},compId:20},{type:"Image",props:{presetID:9,y:-70,width:454,skin:"scene/game_bg_alpha_50.png",sizeGrid:"2,2,2,2",name:"addFriendHintBox",height:60,centerX:0},compId:21,child:[{type:"Label",props:{presetID:10,x:-189,text:"您已发送好友请求，请等待对方同意",name:"addFriendHintLabel",fontSize:26,color:"#ffffff",centerY:0,centerX:0},compId:22}],components:[]}],components:[]},{type:"Script",props:{presetID:11,soundBtn:"@node:19",questionBtn:"@node:20",mikeSwitchBtn:"@node:17",hornSwitchBtn:"@node:18",addFriendHintLabel:"@node:22",addFriendHintBox:"@node:21",addFriendBtn:"@node:16",runtime:"logic/component/TopControlComponent.ts"},compId:23}],components:[]}],loadList:["component/TopControlComponent.prefab"],loadList3D:[],components:[]},t}(o);e.GameViewUI=t;var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.createView(t.uiView)},t.uiView={type:"View",props:{width:750,top:0,right:0,left:0,height:1334,bottom:0,autoDestroyAtClosed:!0},compId:1,child:[{type:"Image",props:{y:240,width:250,var:"testImg",skin:"load/img_loading3.png",height:250,centerX:0},compId:5,child:[{type:"Sprite",props:{y:81,x:64,texture:"load/VS.png"},compId:6}],components:[]},{type:"Image",props:{width:601,skin:"load/loading1.png",height:70,centerX:0,bottom:330},compId:7,child:[{type:"Sprite",props:{y:81,x:226,texture:"load/loading.png"},compId:8},{type:"Sprite",props:{texture:"load/loading2.png",name:"loadBar"},compId:9}],components:[]},{type:"Script",props:{loadIcon:"@node:5",loadBg:"@node:7",loadBar:"@node:9",runtime:"logic/view_logic/LoadLogic.ts"},compId:14}],loadList:["load/img_loading3.png","load/VS.png","load/loading1.png","load/loading.png","load/loading2.png"],loadList3D:[],components:[]},t}(o);e.LoadViewUI=n;var a=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.createView(t.uiView)},t.uiView={type:"View",props:{width:750,top:0,right:0,left:0,height:1334,bottom:0},compId:1,child:[{type:"Image",props:{top:0,skin:"res/game_bg.png",right:0,left:0,bottom:0},compId:3},{type:"Image",props:{top:70,right:10,presetID:1,y:0,x:0,width:88,skin:"scene/wifi.png",isPresetRoot:!0,height:24},compId:4,child:[{type:"Label",props:{presetID:2,y:5,x:56,text:"0ms",name:"delayLabel",color:"#ffffff",anchorX:.5},compId:6},{type:"Script",props:{presetID:3,delayLabel:"@node:6",runtime:"logic/component/NetworkStateComponent.ts"},compId:7}],components:[]},{type:"Script",props:{alertNode:"@Prefab:component/GameAlertComponent.prefab",runtime:"logic/component/GameAlertComponent.ts"},compId:11}],loadList:["res/game_bg.png","component/NetworkState.prefab","component/GameAlertComponent.prefab"],loadList3D:[],components:[]},t}(o);e.MainSceneUI=a}(n.ui||(n.ui={}))},{}]},{},[2]);